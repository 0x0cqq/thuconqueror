# 程序设计实训——战棋大作业文档

软件03 陈启乾 2020012385

[TOC]

## 游戏设定

### 游戏名称

疫情防控保卫战战棋

### 游戏背景

在 0202 年，全球爆发了肺炎疫情。这场疫情直至 1202 年 8 月仍未结束。C 国重要高等学府 T 大，疫情防控 T 大保卫战一触即发。

现在假如你是 T 大校长 Q Boss，请你来指挥学校，与病毒战斗吧！

## 游戏功能实现情况

| 功能要求（50分）                                             | 完成情况                   | 图片概览 |
| ------------------------------------------------------------ | ------------------------- | -------- |
| **界面、交互设计（6分）**                                    |                            |          |
| 标题界面和游戏界面（2分）                                    | 已经实现                           |          |
| 游戏界面可以查看角色和敌人的详细信息（2分）                  | 已经实现                   |          |
| 通过鼠标或键盘实现角色控制以及战斗菜单选择（2分）            | 已经实现                   |          |
| 教程界面或游戏UI说明界面来展示游戏如何操作（1分）            |                            |          |
| **地形设计（4分）**                                          |                            |          |
| 网格状地图（任意规则形状均可，如四边形或六边形）（2分）      | 已经实现       |          |
| 阻挡型地形（角色无法越过）（2分）                            | 已经实现                   |          |
| 损伤型地形（角色...损失生命值）（1分）                       |                            |          |
| 妨碍型地形（角色...移动的最大距离减少）（1分）               | 已经实现，通过消耗移动力不同 |          |
| **敌我方角色设计（11分）**                                   |                            |          |
| 基本属性：生命值、攻击力、机动性、攻击范围（2分）            | 已经实现（但攻击范围均为1）         |          |
| 设计至少3种不同特点的角色（9分）                             |  已经实现，双方合计六种角色          |          |
| 其他属性：防御力、技能等设定（4分）                          |                            |          |
| 其他职能角色，如治疗型角色（2分）                            |                            |          |
| 敌方boss型敌人设计（1分）                                    |                            |          |
| **战斗设计（10分）**                                         |                            |          |
| 回合制机制，每回合每个角色可以各移动和攻击一次（2分）        |    已经实现                        |          |
| 在地图上可视化可移动的范围和可攻击的范围（4分）              | 已经实现                  |          |
| 基本的行动顺序，即一方所有角色行动结束后轮到另一方行动（2分） | 已经实现（但一方可以选择放弃结算）    |          |
| 战斗伤害结算（2分）                                        | 已经实现（采用了比较原始的实现方法）   |          |
| 按照敌我方所有角色的行动速度决定行动顺序（1分）              |                            |          |
| 视野：角色在一定距离内才能发现对方角色（3分）                | （待会协议下） |          |
| **关卡设计（6分）**                                    |                            |          |
| 至少设计两个关卡，有不同的地形，角色有不同限制（4分）        | 已经实现 |          |
| 基本关卡通关判定和失败判定，即敌方全灭或我方全灭（2分）      | 已经实现                           |          |
| rogue-like要素，即一定程度内随机生成地形和敌人以及对我方可放置角色种类和数量的限制条件（3分） |                            |          |
| 通过合理设计上一点来使得关卡难度随关卡进行逐渐提高（1分）    |                            |          |
| 其他通关判定方式，如占领特定位置或击败敌方boss（1分）        | 采用了攻占大本营的方式 |          |
| **敌方AI设计（4分）**                                        |                            |          |
| 基本的行动逻辑，即会不断靠近我方角色并发起攻击（4分）        | 已经实现（其实是会靠近大本营，因为那个是胜利条件） |          |
| 为不同的敌人类型设计不同的行动策略（2分）                    |                            |          |
| 设计不同的难度，难度越高敌方行动逻辑越复杂（2分）            |                            |          |
| **其他要求（9分）**                                          |                            |          |
| 游戏背景音乐、音效（2分）                                    |    已经实现              |          |
| 图片素材（请自行寻找）（3分）                                | 已经实现 |          |
| 动画效果：角色移动动画、战斗效果等（4分）                    | 已经实现                   |          |
| 剧情设计（2分）                                              | 已经实现 |          |
| 战斗复盘（3分）                                              |                            |          |

> 功能要求包含基本要求和提高要求，完成基本要求就可以最高得到 50 分，完成提高要求有额外加分，但需要注意，提高要求会根据完成度和质量进行赋分，分值不会超过该项的分数。另外，额外加分仅仅作用于大作业本身分数。加分不会使大作业本身分数突破限制，即当大作业本身分数超过 100 分时，在总成绩计算中大作业按 100 分进入加权计算。

## 游戏代码实现情况

| 代码要求（20分）                                        | 实现情况 | 具体阐述或图片佐证                                           |
| ------------------------------------------------------- | -------- | ------------------------------------------------------------ |
| 要求使⽤C++和QT进行编写。                               | 是的     |                                                              |
| 要求使⽤⾯向对象的编程思想（5分）                       | 已经实现 | 大量继承 `QObject` ，并且图形界面采用对一个对象就新产生一个类 |
| 代码应当有统⼀的⻛格（4分）                             | 已经实现 | 在代码样貌上，采用 `clang-format` 统一代码风格；在命名上，采用驼峰命名法。 |
| 代码应当包含必要的注释（4分）                           |          |                                                              |
| 代码应该合理设计类之间的关系以保证类的良好封装性（2分） | 已经实现 | 如上图所示。                                                 |
| 程序应当拥有较高的运行效率（5分）                       | 已经实现 | 整体流畅运行。[^1]                                           |

## 文档实现情况

| 文档要求（10分）           |      |      |
| -------------------------- | ---- | ---- |
| （你的文档应该包括）       |      |      |
| 各个程序模块之间的逻辑关系 |      |      |
| 程序运行的主要流程         |      |      |
| 简要说明各个功能的演示⽅法 |      |      |
| 参考文献或引用代码出处     |      |      |
| 文档简洁，清晰易懂（10分） |      |      |

请在文档中清晰有条理地说明你的项目达到了哪些要求，助教将根据文档中出现的内容结合你的可执行文件进行评分。对你所实现的新创意，也请在文档中进行阐述。

## 游戏技术路线

游戏图形采用 Qt 5.15.2 中的 Graphics Framework 搭建，同时也在某些页面使用了 `ui form` 进行图形界面设计。

游戏采用了面向对象的编程方法，类的构造结构大致如下。

为了构造一局游戏，有四种类会被创造出来：

1. 总体管理游戏，沟通游戏逻辑、游戏图形界面。这种包括：`Game` 类、`GraphView` 类。
2. 创建、管理图形界面，接收并判断用户图形界面输入指令的合法性，并通过图形化的方法给出游戏运行的结果。这种包括：`Field` 类，`Block`类，`Unit` 类。
3. 创建、计算游戏逻辑，接收图形界面给出的游戏指令，计算得到游戏局面状态的变化。这种包括：`GraphField` 类，`GraphBlock`类，`GraphUnit` 类。
4. 管理游戏数据，提供给以上 2 和 3 使用计算、绘图等，并且由 1 负责管理。这种包括：`UnitStatus` 类，`BlockStatus` 类。

为了更清晰的说明以上逻辑，以下是程序大致的执行顺序

[^1]: 因为技术路线（采用 Qt Graphics Framework）的缘故，再加上游戏的资源分辨率和清晰度很高，在动图更新重绘的成本会很高，所以运行时内存占用和 CPU 占用会很高。但考虑到其作者的轻薄本上也能够流畅运行，所以作者认为这个程序的运行销量是可以算高的。

